import{o as e}from"./index.10347039.js";import"./index.3acf80ef.js";import{N as t,r as n,C as r,bg as o,a6 as i,R as l,z as u,aZ as a}from"./vendor.f7b6e8c4.js";import{R as c}from"./index.67d96992.js";var s=["children","trigger","onVisibleChange","drawerProps","onFinish","title","width"];function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t,n,r,o,i,l){try{var u=e[i](l),a=u.value}catch(c){return void n(c)}u.done?t(a):Promise.resolve(a).then(r,o)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,o,i=[],l=!0,u=!1;try{for(n=n.call(e);!(l=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);l=!0);}catch(a){u=!0,o=a}finally{try{l||null==n.return||n.return()}finally{if(u)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function h(p){var m,b,h=p.children,O=p.trigger,C=p.onVisibleChange,x=p.drawerProps,j=p.onFinish,w=p.title,P=p.width,E=g(p,s),k=y(t(!!E.visible,{value:E.visible,onChange:C}),2),R=k[0],S=k[1],F=n.exports.useContext(r.ConfigContext),D=n.exports.useMemo((function(){var e,t;return(null==x?void 0:x.getContainer)?"function"==typeof(null==x?void 0:x.getContainer)?null==x||null===(t=x.getContainer)||void 0===t?void 0:t.call(x):"string"==typeof(null==x?void 0:x.getContainer)?document.getElementById(null==x?void 0:x.getContainer):null==x?void 0:x.getContainer:null==F||null===(e=F.getPopupContainer)||void 0===e?void 0:e.call(F,document.body)}),[F,x,R]),A=y(n.exports.useState((function(){return new o({container:D||document.body})})),1)[0];i(!E.footer||!(null==x?void 0:x.footer),"DrawerForm 是一个 ProForm 的特殊布局，如果想自定义按钮，请使用 submit.render 自定义。"),n.exports.useEffect((function(){return R?A.lock():A.unLock(),R&&E.visible&&(null==C||C(!0)),function(){var e;R||null==A||null===(e=A.unLock)||void 0===e||e.call(A)}}),[R]);var I=n.exports.useRef(!(null==x?void 0:x.forceRender)),T=n.exports.useMemo((function(){return(!I.current||!1!==R)&&(!1!==R||!(null==x?void 0:x.destroyOnClose))}),[R,null==x?void 0:x.destroyOnClose]),B=n.exports.useRef();return n.exports.useEffect((function(){var e;(R&&(I.current=!1),R&&(null==x?void 0:x.destroyOnClose))&&(null===(e=B.current)||void 0===e||e.resetFields())}),[null==x?void 0:x.destroyOnClose,R]),n.exports.useEffect((function(){return function(){var e;null==A||null===(e=A.unLock)||void 0===e||e.call(A)}}),[]),n.exports.useImperativeHandle(E.formRef,(function(){return B.current})),l.createElement(l.Fragment,null,u.exports.createPortal(l.createElement("div",{onClick:function(e){return e.stopPropagation()}},l.createElement(c,f({formComponentType:"DrawerForm",layout:"vertical"},e(E,["visible"]),{formRef:B,submitter:!1!==E.submitter&&v(v({},E.submitter),{},{searchConfig:v({submitText:"确认",resetText:"取消"},null===(m=E.submitter)||void 0===m?void 0:m.searchConfig),resetButtonProps:v({preventDefault:!0,onClick:function(e){var t;S(!1),null==x||null===(t=x.onClose)||void 0===t||t.call(x,e)}},null===(b=E.submitter)||void 0===b?void 0:b.resetButtonProps)}),onFinish:function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,j(t);case 4:e.sent&&(S(!1),setTimeout((function(){var e;(null==x?void 0:x.destroyOnClose)&&(null===(e=B.current)||void 0===e||e.resetFields())}),300));case 6:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function l(e){d(i,r,o,l,u,"next",e)}function u(e){d(i,r,o,l,u,"throw",e)}l(void 0)}))});return function(e){return t.apply(this,arguments)}}(),contentRender:function(e,t){return l.createElement(a,f({title:w,width:P||800},x,{getContainer:!1,visible:R,onClose:function(e){var t;S(!1),null==x||null===(t=x.onClose)||void 0===t||t.call(x,e)},footer:!!t&&l.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t)}),T?e:null)}}),h)),D||document.body),O&&l.cloneElement(O,v(v({},O.props),{},{onClick:function(e){var t,n;S(!R),null===(t=O.props)||void 0===t||null===(n=t.onClick)||void 0===n||n.call(t,e)}})))}export{h as D};
